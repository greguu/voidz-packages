# Template file for 'cmus'
pkgname=cmus
version=2.12.0
revision=1
build_style=configure
configure_args="prefix=/usr LD=$CC"
hostmakedepends="pkg-config"
makedepends="ncurses-devel libflac-devel libmad-devel libmodplug-devel opusfile-devel alsa-lib-devel tremor-git-devel $(vopt_if elogind elogind-devel)"
short_desc="Small, fast and powerful console music player"
maintainer="Orphaned <orphan@voidlinux.org>"
license="GPL-2.0-or-later"
homepage="https://cmus.github.io"
distfiles="https://github.com/cmus/cmus/archive/v${version}.tar.gz"
checksum=44b96cd5f84b0d84c33097c48454232d5e6a19cd33b9b6503ba9c13b6686bfc7
build_options="elogind"
build_options_default="elogind"
desc_option_elogind="Support MPRIS interface via elogind"

if [ "$XBPS_TARGET_NO_ATOMIC8" ]; then
	makedepends+=" libatomic-devel"
	export LDLIBS+=" -latomic"
fi

cmus-flac_package() {
	short_desc+=" - FLAC input plugin"
	depends="${sourcepkg}>=${version}_${revision}"
	pkg_install() {
		vmove usr/lib/cmus/ip/flac.so
	}
}
cmus-modplug_package() {
	short_desc+=" - MOD input plugin"
	depends="${sourcepkg}>=${version}_${revision}"
	pkg_install() {
		vmove usr/lib/cmus/ip/modplug.so
	}
}
cmus-opus_package() {
	short_desc+=" - Opus input plugin"
	depends="${sourcepkg}>=${version}_${revision}"
	pkg_install() {
		vmove usr/lib/cmus/ip/opus.so
	}
}
